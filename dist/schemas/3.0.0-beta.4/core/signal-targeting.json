{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/3.0.0-beta.4/core/signal-targeting.json",
  "title": "Signal Targeting",
  "description": "Targeting constraint for a specific signal. Uses value_type as discriminator to determine the targeting expression format.",
  "discriminator": {
    "propertyName": "value_type"
  },
  "oneOf": [
    {
      "type": "object",
      "description": "Binary signal targeting - user either matches or doesn't",
      "properties": {
        "signal_id": {
          "$ref": "/schemas/3.0.0-beta.4/core/signal-id.json",
          "description": "The signal to target"
        },
        "value_type": {
          "type": "string",
          "const": "binary",
          "description": "Discriminator for binary signals"
        },
        "value": {
          "type": "boolean",
          "description": "Whether to include (true) or exclude (false) users matching this signal"
        }
      },
      "required": ["signal_id", "value_type", "value"],
      "additionalProperties": true
    },
    {
      "type": "object",
      "description": "Categorical signal targeting - target users with specific values",
      "properties": {
        "signal_id": {
          "$ref": "/schemas/3.0.0-beta.4/core/signal-id.json",
          "description": "The signal to target"
        },
        "value_type": {
          "type": "string",
          "const": "categorical",
          "description": "Discriminator for categorical signals"
        },
        "values": {
          "type": "array",
          "description": "Values to target. Users with any of these values will be included.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        }
      },
      "required": ["signal_id", "value_type", "values"],
      "additionalProperties": true
    },
    {
      "type": "object",
      "description": "Numeric signal targeting - target users within a value range. If min_value is provided, it must be <= max_value. Values should be within the signal's defined range (see signal definition).",
      "properties": {
        "signal_id": {
          "$ref": "/schemas/3.0.0-beta.4/core/signal-id.json",
          "description": "The signal to target"
        },
        "value_type": {
          "type": "string",
          "const": "numeric",
          "description": "Discriminator for numeric signals"
        },
        "min_value": {
          "type": "number",
          "description": "Minimum value (inclusive). Omit for no minimum. Must be <= max_value when both are provided. Should be >= signal's range.min if defined."
        },
        "max_value": {
          "type": "number",
          "description": "Maximum value (inclusive). Omit for no maximum. Must be >= min_value when both are provided. Should be <= signal's range.max if defined."
        }
      },
      "required": ["signal_id", "value_type"],
      "additionalProperties": true
    }
  ]
}
